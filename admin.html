<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>RBS88 Admin Panel</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@600;700;800&display=swap" rel="stylesheet">
<style>
:root{
--bg:#060810;--bg2:#0a0d16;--bg3:#0e111c;
--card:rgba(16,19,34,.85);
--g1:rgba(255,255,255,.02);--g2:rgba(255,255,255,.04);--g3:rgba(255,255,255,.07);
--gold:#f0b90b;--gold2:#c99a08;--gd:rgba(240,185,11,.06);
--green:#00d68f;--grd:rgba(0,214,143,.06);
--red:#ff3b5c;--rdd:rgba(255,59,92,.06);
--blue:#4da6ff;--bld:rgba(77,166,255,.06);
--purple:#9b6dff;--prd:rgba(155,109,255,.06);
--cyan:#00e5ff;--orange:#ff8c00;
--t1:#f5f5f7;--t2:#8e8e93;--t3:#48484a;
--b1:rgba(255,255,255,.04);--b2:rgba(255,255,255,.08);--b3:rgba(255,255,255,.13);
--f:'Inter',system-ui,sans-serif;--m:'JetBrains Mono',monospace;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:var(--f);background:var(--bg);color:var(--t1);min-height:100vh;display:flex;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:var(--gold2);border-radius:4px}
button{cursor:pointer;border:none;font-family:inherit;outline:none;background:none;color:inherit}
input,select,textarea{font-family:inherit;outline:none}

/* TOAST */
.toc{position:fixed;top:12px;right:12px;z-index:9999;display:flex;flex-direction:column;gap:5px;max-width:320px;pointer-events:none}
.to{padding:9px 12px;border-radius:8px;font-size:.72rem;font-weight:600;color:#fff;pointer-events:auto;position:relative;overflow:hidden;box-shadow:0 5px 16px rgba(0,0,0,.2);display:flex;align-items:center;gap:5px;animation:toIn .25s ease}
@keyframes toIn{from{transform:translateX(60px);opacity:0}to{transform:none;opacity:1}}
.to::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px;background:rgba(255,255,255,.1);animation:toB 3.2s linear forwards}
@keyframes toB{to{transform:scaleX(0);transform-origin:left}}
.ts{background:rgba(0,214,143,.82)}.te{background:rgba(255,59,92,.82)}.ti{background:rgba(77,166,255,.82)}.tw{background:rgba(255,170,0,.82);color:#000}

/* SIDEBAR */
.sb{width:220px;min-height:100vh;position:fixed;top:0;left:0;bottom:0;background:var(--bg2);border-right:1px solid var(--b1);display:flex;flex-direction:column;z-index:100;overflow-y:auto;transition:transform .25s}
.sb-h{padding:14px;border-bottom:1px solid var(--b1)}
.sb-lg{display:flex;align-items:center;gap:7px}
.sb-lm{width:28px;height:28px;border-radius:6px;background:linear-gradient(135deg,var(--gold),var(--gold2));display:flex;align-items:center;justify-content:center;font-weight:900;font-size:.72rem;color:#000}
.sb-lt{font-size:.9rem;font-weight:800;letter-spacing:.8px}.sb-lt .lg{color:var(--gold)}.sb-lt .ld{color:var(--t2);font-weight:600}
.sb-su{font-size:.48rem;color:var(--t3);margin-top:1px;font-weight:500}
.sb-n{flex:1;padding:6px 0}
.sb-sc{padding:10px 14px 2px;font-size:.44rem;text-transform:uppercase;letter-spacing:2px;color:var(--t3);font-weight:700}
.sb-i{display:flex;align-items:center;gap:7px;padding:7px 14px;margin:1px 5px;border-radius:6px;font-size:.72rem;font-weight:600;color:var(--t2);cursor:pointer;transition:all .1s;border-left:2px solid transparent}
.sb-i:hover{background:var(--g2);color:var(--t1)}
.sb-i.act{background:var(--gd);color:var(--gold);border-left-color:var(--gold)}
.sb-i .si{font-size:.8rem;width:18px;text-align:center}
.sb-i .bdg{margin-left:auto;padding:0 5px;border-radius:5px;font-size:.46rem;font-weight:700;background:var(--red);color:#fff;min-width:14px;text-align:center;line-height:1.5}
.sb-f{padding:10px 14px;border-top:1px solid var(--b1);font-size:.58rem;color:var(--t3)}
.sb-f a{color:var(--gold);font-weight:600;text-decoration:none}

.sbt{display:none;position:fixed;top:8px;left:8px;z-index:200;width:32px;height:32px;border-radius:6px;background:var(--bg2);border:1px solid var(--b1);color:var(--gold);font-size:.9rem;align-items:center;justify-content:center}

/* MAIN */
.mn{flex:1;margin-left:220px;min-height:100vh}
.mn-h{position:sticky;top:0;z-index:50;background:rgba(6,8,16,.82);backdrop-filter:blur(10px);border-bottom:1px solid var(--b1);padding:10px 18px;display:flex;align-items:center;justify-content:space-between}
.mhl h1{font-size:.9rem;font-weight:800}.mhl p{font-size:.6rem;color:var(--t3);margin-top:1px}
.mht{font-family:var(--m);font-size:.64rem;color:var(--t2);background:var(--g2);padding:3px 8px;border-radius:5px;border:1px solid var(--b1);display:flex;align-items:center;gap:5px}
.ld{display:inline-block;width:5px;height:5px;border-radius:50%;background:var(--green);animation:ldp 2s infinite}
@keyframes ldp{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.35;transform:scale(.65)}}
.mn-c{padding:14px 18px}

/* STATS */
.stg{display:grid;grid-template-columns:repeat(auto-fill,minmax(155px,1fr));gap:8px;margin-bottom:14px}
.stc{background:var(--card);border:1px solid var(--b1);border-radius:8px;padding:12px;position:relative;overflow:hidden;transition:border-color .12s}
.stc:hover{border-color:var(--b2)}
.stc::before{content:'';position:absolute;top:0;left:0;right:0;height:1.5px;background:linear-gradient(90deg,transparent,var(--gold),transparent);opacity:.15}
.sci{font-size:.9rem;margin-bottom:4px}
.scv{font-family:var(--m);font-size:1.05rem;font-weight:800;color:var(--gold)}
.scl{font-size:.52rem;color:var(--t3);margin-top:1px;font-weight:500}

/* TABLE */
.tc{background:var(--card);border:1px solid var(--b1);border-radius:8px;overflow:hidden;margin-bottom:12px}
.tch{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid var(--b1);flex-wrap:wrap;gap:4px}
.tch h3{font-size:.78rem;font-weight:700;display:flex;align-items:center;gap:5px}
.tca{display:flex;gap:3px}
.tcb{overflow-x:auto}
table{width:100%;border-collapse:collapse}
thead{background:rgba(0,0,0,.18)}
th{padding:7px 10px;text-align:left;font-size:.5rem;color:var(--t3);text-transform:uppercase;letter-spacing:.8px;font-weight:700;border-bottom:1px solid var(--b1);white-space:nowrap}
td{padding:8px 10px;font-size:.7rem;border-bottom:1px solid rgba(255,255,255,.012);white-space:nowrap}
tr:hover td{background:rgba(240,185,11,.008)}
.bg{display:inline-block;padding:1px 6px;border-radius:5px;font-size:.5rem;font-weight:700}
.ba2{background:var(--grd);color:var(--green)}.bb{background:var(--rdd);color:var(--red)}
.bn2{background:var(--gd);color:var(--gold)}.bw{background:var(--grd);color:var(--green)}
.bl2{background:var(--rdd);color:var(--red)}.bc{background:var(--prd);color:var(--purple)}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:3px;padding:5px 12px;border-radius:6px;font-weight:700;font-size:.64rem;transition:all .12s;white-space:nowrap;position:relative;overflow:hidden}
.btn::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,.06),transparent);opacity:0;transition:opacity .12s}
.btn:hover::before{opacity:1}
.btn:hover{transform:translateY(-1px)}
.bg2{background:linear-gradient(135deg,var(--gold),var(--gold2));color:#000;box-shadow:0 1px 6px rgba(240,185,11,.08)}
.bgr{background:linear-gradient(135deg,var(--green),#00a870);color:#fff}
.br{background:linear-gradient(135deg,var(--red),#cc2040);color:#fff}
.bbl{background:linear-gradient(135deg,var(--blue),#3080cc);color:#fff}
.bpu{background:linear-gradient(135deg,var(--purple),#7c4dff);color:#fff}
.bgh{background:var(--g2);border:1px solid var(--b2);color:var(--t2)}
.bgh:hover{border-color:var(--b3);color:var(--t1)}
.bxs{padding:2px 6px;font-size:.54rem;border-radius:4px}
.bsm{padding:4px 8px;font-size:.58rem}

/* FORMS */
.fc{background:var(--card);border:1px solid var(--b1);border-radius:8px;padding:14px;margin-bottom:10px}
.fc h3{font-size:.78rem;font-weight:700;margin-bottom:8px;color:var(--gold);display:flex;align-items:center;gap:5px}
.fg{margin-bottom:8px}
.fg label{display:block;font-size:.62rem;color:var(--t2);margin-bottom:2px;font-weight:600}
.fi{width:100%;padding:7px 10px;background:var(--g2);border:1px solid var(--b1);border-radius:6px;color:var(--t1);font-size:.72rem;transition:border-color .12s}
.fi:focus{border-color:rgba(240,185,11,.15)}
.fi::placeholder{color:var(--t3)}
.fr{display:grid;grid-template-columns:1fr 1fr;gap:6px}

/* WIN CONTROL */
.wc{background:var(--card);border:1.5px solid var(--b1);border-radius:8px;padding:14px;margin-bottom:8px;transition:border-color .15s;position:relative}
.wc:hover{border-color:var(--b2)}
.wc::before{content:'';position:absolute;top:0;left:14px;right:14px;height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent);opacity:.1}
.wch{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;flex-wrap:wrap;gap:5px}
.wcu{display:flex;align-items:center;gap:7px}
.wcav{width:30px;height:30px;border-radius:50%;background:linear-gradient(135deg,var(--gold),var(--orange));display:flex;align-items:center;justify-content:center;font-weight:900;font-size:.7rem;color:#000}
.wcnm{font-weight:700;font-size:.76rem}
.wcmt{font-size:.52rem;color:var(--t3);margin-top:1px}
.wcbl{font-family:var(--m);font-weight:800;font-size:.68rem;color:var(--gold);background:var(--gd);padding:2px 8px;border-radius:5px;border:1px solid rgba(240,185,11,.06)}
.wccr{padding:3px 8px;border-radius:5px;font-size:.58rem;font-weight:700;margin-bottom:6px;display:inline-flex;align-items:center;gap:3px}
.wccr.mn2{background:var(--gd);color:var(--gold);border:1px solid rgba(240,185,11,.08)}
.wccr.mw{background:var(--grd);color:var(--green);border:1px solid rgba(0,214,143,.08)}
.wccr.ml{background:var(--rdd);color:var(--red);border:1px solid rgba(255,59,92,.08)}
.wccr.mc{background:var(--prd);color:var(--purple);border:1px solid rgba(155,109,255,.08)}
.wcms{display:flex;gap:3px;flex-wrap:wrap;margin-bottom:6px}
.wcmb{padding:5px 12px;border-radius:6px;font-size:.62rem;font-weight:700;border:1.5px solid var(--b1);background:var(--bg3);color:var(--t3);cursor:pointer;transition:all .12s}
.wcmb:hover{border-color:var(--b3);color:var(--t1)}
.wcmb.active{transform:scale(1.02)}
.wcmb.mn3{border-color:var(--gold);color:var(--gold)}.wcmb.mn3.active{background:var(--gd)}
.wcmb.mw2{border-color:var(--green);color:var(--green)}.wcmb.mw2.active{background:var(--grd)}
.wcmb.ml2{border-color:var(--red);color:var(--red)}.wcmb.ml2.active{background:var(--rdd)}
.wcmb.mc2{border-color:var(--purple);color:var(--purple)}.wcmb.mc2.active{background:var(--prd)}
.rtpw{margin-top:6px}
.rtpw label{font-size:.62rem;font-weight:600;color:var(--t2);display:flex;align-items:center;justify-content:space-between}
.rtpw .rv{font-family:var(--m);font-weight:800;font-size:.8rem;color:var(--purple)}
.rts{width:100%;margin:3px 0;-webkit-appearance:none;appearance:none;height:4px;border-radius:2px;background:linear-gradient(90deg,var(--red),var(--gold),var(--green));outline:none}
.rts::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:var(--purple);border:2px solid #fff;cursor:pointer;box-shadow:0 1px 5px rgba(155,109,255,.2)}
.rts::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:var(--purple);border:2px solid #fff;cursor:pointer}
.rtpl{display:flex;justify-content:space-between;font-size:.44rem;color:var(--t3)}

.alt{padding:8px 12px;border-radius:6px;font-size:.66rem;font-weight:600;margin-bottom:10px;display:flex;align-items:center;gap:5px}
.alw{background:rgba(255,170,0,.03);border:1px solid rgba(255,170,0,.08);color:var(--orange)}
.ali{background:var(--bld);border:1px solid rgba(77,166,255,.08);color:var(--blue)}

.empty{text-align:center;padding:28px 14px;color:var(--t3);font-size:.76rem}
.empty .emi{font-size:2rem;margin-bottom:6px;opacity:.2}

@media(max-width:800px){.sb{transform:translateX(-100%)}.sb.open{transform:none}.sbt{display:flex}.mn{margin-left:0}.stg{grid-template-columns:repeat(2,1fr)}.fr{grid-template-columns:1fr}}
@media(max-width:480px){.stg{grid-template-columns:1fr}.mn-c{padding:10px 12px}.mn-h{padding:8px 12px}}
</style>
</head>
<body>
<div class="toc" id="toC"></div>
<button class="sbt" onclick="document.getElementById('sb').classList.toggle('open')">‚ò∞</button>
<nav class="sb" id="sb">
<div class="sb-h"><div class="sb-lg"><div class="sb-lm">R</div><div><div class="sb-lt"><span class="lg">RBS</span><span class="ld">88</span></div><div class="sb-su">Admin Panel</div></div></div></div>
<div class="sb-n">
<div class="sb-i act" onclick="go('dash')"><span class="si">üìä</span>Dashboard</div>
<div class="sb-i" onclick="go('users')"><span class="si">üë•</span>Users</div>
<div class="sb-sc">üéÆ Game Control</div>
<div class="sb-i" onclick="go('wc')"><span class="si">üéØ</span>Win Control<span class="bdg" id="wcB">0</span></div>
<div class="sb-i" onclick="go('grtp')"><span class="si">üìà</span>Global RTP</div>
<div class="sb-sc">üí∞ Finance</div>
<div class="sb-i" onclick="go('tx')"><span class="si">üí≥</span>Transactions</div>
<div class="sb-i" onclick="go('ab')"><span class="si">üí∞</span>Add Balance</div>
<div class="sb-sc">‚öôÔ∏è System</div>
<div class="sb-i" onclick="go('pr')"><span class="si">üéÅ</span>Promos</div>
<div class="sb-i" onclick="go('st')"><span class="si">‚öôÔ∏è</span>Settings</div>
<div class="sb-i" onclick="go('bc')"><span class="si">üì¢</span>Broadcast</div>
</div>
<div class="sb-f"><a href="index.html">‚Üê Website</a> | <a href="game.html">üé∞ Game</a></div>
</nav>
<div class="mn"><div class="mn-h"><div class="mhl"><h1 id="pT">üìä Dashboard</h1><p id="pS">Real-time overview</p></div><div class="mht"><span class="ld"></span><span id="clk"></span></div></div><div class="mn-c" id="ct"></div></div>

<script>
const D={g(k,d=null){try{return JSON.parse(localStorage.getItem('rbs88_'+k))||d}catch{return d}},s(k,v){localStorage.setItem('rbs88_'+k,JSON.stringify(v))}};
const fm=n=>(n||0).toLocaleString('id-ID'),fR=n=>'Rp '+fm(n);
const sync=()=>localStorage.setItem('rbs88_sync',Date.now().toString());
let cp='dash';
function toast(t,m){const c=document.getElementById('toC'),e=document.createElement('div');e.className='to t'+t;e.innerHTML=`<span>${{s:'‚úÖ',e:'‚ùå',i:'‚ÑπÔ∏è',w:'‚ö†Ô∏è'}[t]||''}</span><span>${m}</span>`;c.appendChild(e);setTimeout(()=>{e.style.opacity='0';e.style.transition='opacity .25s';setTimeout(()=>e.remove(),250)},3200)}
setInterval(()=>{const d=new Date(),e=document.getElementById('clk');if(e)e.textContent=d.toLocaleTimeString('id-ID')},1e3);
setInterval(()=>{if(cp==='dash'||cp==='wc')go(cp);uBdg()},4e3);
function uBdg(){const n=D.g('users',[]).filter(u=>u.role==='user'&&u.winMode&&u.winMode!=='normal').length,e=document.getElementById('wcB');if(e){e.textContent=n;e.style.display=n?'inline':'none'}}
function go(p){cp=p;document.querySelectorAll('.sb-i').forEach(x=>x.classList.remove('act'));document.querySelectorAll('.sb-i').forEach(x=>{if(x.onclick&&x.onclick.toString().includes("'"+p+"'"))x.classList.add('act')});const ts={dash:['üìä Dashboard','Real-time overview'],users:['üë• Users','Manage members'],wc:['üéØ Win Control','Synced real-time'],grtp:['üìà Global RTP','Default win rate'],tx:['üí≥ Transactions','All activity'],ab:['üí∞ Add Balance','Manual credit'],pr:['üéÅ Promos','Manage codes'],st:['‚öôÔ∏è Settings','Configuration'],bc:['üì¢ Broadcast','Send bonus to all']};const[t,s]=ts[p]||['',''];document.getElementById('pT').textContent=t;document.getElementById('pS').textContent=s;({dash:rD,users:rU,wc:rW,grtp:rG,tx:rT,ab:rA,pr:rP,st:rS,bc:rB}[p]||rD)();uBdg();document.getElementById('sb').classList.remove('open')}

function rD(){
const us=D.g('users',[]).filter(u=>u.role==='user'),tx=D.g('transactions',[]);
const tD=tx.filter(t=>t.type==='deposit').reduce((s,t)=>s+Math.abs(t.amount),0);
const tW=tx.filter(t=>t.type==='withdraw').reduce((s,t)=>s+Math.abs(t.amount),0);
const tBl=us.reduce((s,u)=>s+(u.balance||0),0);
const tBt=us.reduce((s,u)=>s+(u.totalBet||0),0);
const tWn=us.reduce((s,u)=>s+(u.totalWin||0),0);
const pf=tD-tW,he=tBt-tWn;
document.getElementById('ct').innerHTML=`
<div class="stg">
<div class="stc"><div class="sci">üë•</div><div class="scv">${us.length}</div><div class="scl">Members</div></div>
<div class="stc"><div class="sci">üí∞</div><div class="scv">${fR(tD)}</div><div class="scl">Total Deposit</div></div>
<div class="stc"><div class="sci">üí∏</div><div class="scv">${fR(tW)}</div><div class="scl">Total WD</div></div>
<div class="stc"><div class="sci">üè¶</div><div class="scv">${fR(tBl)}</div><div class="scl">Balances</div></div>
<div class="stc"><div class="sci">üìä</div><div class="scv" style="color:${pf>=0?'var(--green)':'var(--red)'}">${fR(pf)}</div><div class="scl">Net Profit</div></div>
<div class="stc"><div class="sci">üè†</div><div class="scv" style="color:${he>=0?'var(--green)':'var(--red)'}">${fR(he)}</div><div class="scl">House Edge</div></div>
</div>
<div class="tc"><div class="tch"><h3><span class="ld"></span> Win Modes</h3><div class="tca"><button class="btn bg2 bsm" onclick="go('wc')">üéØ Control</button></div></div>
<div class="tcb"><table><thead><tr><th>User</th><th>Balance</th><th>Mode</th><th>Games</th><th>Bet</th><th>Win</th><th></th></tr></thead><tbody>
${us.map(u=>{const m=u.winMode||'normal',bc=m==='always_win'?'bw':m==='always_lose'?'bl2':m==='custom_rtp'?'bc':'bn2',ml=m==='always_win'?'üü¢ WIN':m==='always_lose'?'üî¥ LOSE':m==='custom_rtp'?'üü£ '+u.customRtp+'%':'üü° Normal';return`<tr><td style="font-weight:700">${u.username}</td><td><span style="color:var(--gold);font-family:var(--m);font-weight:700">${fR(u.balance)}</span></td><td><span class="bg ${bc}">${ml}</span></td><td>${fm(u.totalGames||0)}</td><td>${fR(u.totalBet||0)}</td><td style="color:var(--green)">${fR(u.totalWin||0)}</td><td><button class="btn bg2 bxs" onclick="go('wc')">‚öôÔ∏è</button></td></tr>`}).join('')||'<tr><td colspan="7" class="empty">No members</td></tr>'}
</tbody></table></div></div>`}

function rU(){
const us=D.g('users',[]);
document.getElementById('ct').innerHTML=`<div class="tc"><div class="tch"><h3>üë• Users (${us.length})</h3></div><div class="tcb"><table><thead><tr><th>User</th><th>Email</th><th>Bank</th><th>Balance</th><th>VIP</th><th>Mode</th><th>Status</th><th>Actions</th></tr></thead><tbody>
${us.map(u=>`<tr><td style="font-weight:700">${u.username}${u.role==='admin'?' <span class="bg bc">ADMIN</span>':''}</td><td style="color:var(--t2);font-size:.62rem">${u.email||'-'}</td><td style="font-size:.62rem">${u.bank||'-'}</td><td><span style="color:var(--gold);font-family:var(--m);font-weight:700">${fR(u.balance)}</span></td><td>${u.vip||'Bronze'}</td><td><span class="bg ${u.winMode==='always_win'?'bw':u.winMode==='always_lose'?'bl2':u.winMode==='custom_rtp'?'bc':'bn2'}">${(u.winMode||'normal').replace(/_/g,' ')}</span></td><td><span class="bg ${u.status==='active'?'ba2':'bb'}">${u.status}</span></td><td>${u.role!=='admin'?`${u.status==='active'?`<button class="btn br bxs" onclick="ban(${u.id})">Ban</button>`:`<button class="btn bgr bxs" onclick="unb(${u.id})">Unban</button>`} <button class="btn bbl bxs" onclick="rpw(${u.id})">PW</button>`:'‚Äî'}</td></tr>`).join('')}
</tbody></table></div></div>`}
function ban(id){const u=D.g('users',[]),f=u.find(x=>x.id===id);if(f){f.status='banned';D.s('users',u);sync();toast('s',f.username+' banned');go('users')}}
function unb(id){const u=D.g('users',[]),f=u.find(x=>x.id===id);if(f){f.status='active';D.s('users',u);sync();toast('s',f.username+' unbanned');go('users')}}
function rpw(id){const u=D.g('users',[]),f=u.find(x=>x.id===id);if(f){f.password='123456';D.s('users',u);toast('i',f.username+' PW‚Üí123456')}}

function rW(){
const us=D.g('users',[]).filter(u=>u.role==='user'),cs=us.filter(u=>u.winMode&&u.winMode!=='normal').length;
document.getElementById('ct').innerHTML=`
<div class="alt alw">‚ö†Ô∏è <strong>Changes apply INSTANTLY!</strong> Next spin uses new setting.</div>
<div class="alt ali">‚ÑπÔ∏è <strong>${cs}</strong> custom mode(s). Others use Global RTP (${D.g('settings',{globalRtp:70}).globalRtp}%).</div>
${us.length?us.map(u=>{const m=u.winMode||'normal',modes=[{id:'normal',l:'üü° Normal',c:'mn3'},{id:'always_win',l:'üü¢ Win',c:'mw2'},{id:'always_lose',l:'üî¥ Lose',c:'ml2'},{id:'custom_rtp',l:'üü£ Custom',c:'mc2'}],cc=m==='always_win'?'mw':m==='always_lose'?'ml':m==='custom_rtp'?'mc':'mn2',cl=modes.find(x=>x.id===m)?.l||'Normal';
return`<div class="wc"><div class="wch"><div class="wcu"><div class="wcav">${u.username[0].toUpperCase()}</div><div><div class="wcnm">${u.username}</div><div class="wcmt">VIP:${u.vip||'Bronze'} ‚Ä¢ G:${fm(u.totalGames||0)} ‚Ä¢ W:${fR(u.totalWin||0)}</div></div></div><div class="wcbl">${fR(u.balance)}</div></div>
<div class="wccr ${cc}">Now: ${cl}${m==='custom_rtp'?' ('+u.customRtp+'%)':''}</div>
<div class="wcms">${modes.map(x=>`<button class="wcmb ${x.c}${m===x.id?' active':''}" onclick="sM(${u.id},'${x.id}')">${x.l}</button>`).join('')}</div>
${m==='custom_rtp'?`<div class="rtpw"><label>Rate: <span class="rv" id="rv${u.id}">${u.customRtp||70}%</span></label><input type="range" class="rts" min="0" max="100" value="${u.customRtp||70}" oninput="sR(${u.id},this.value)"><div class="rtpl"><span>0%</span><span>50%</span><span>100%</span></div></div>`:''}
</div>`}).join(''):'<div class="empty"><div class="emi">üë•</div>No members</div>'}`}
function sM(uid,mode){const us=D.g('users',[]),u=us.find(x=>x.id===uid);if(!u)return;u.winMode=mode;if(mode==='custom_rtp'&&!u.customRtp)u.customRtp=70;D.s('users',us);sync();toast('s',u.username+' ‚Üí '+mode.replace(/_/g,' '));go('wc')}
function sR(uid,v){const us=D.g('users',[]),u=us.find(x=>x.id===uid);if(!u)return;u.customRtp=parseInt(v);D.s('users',us);sync();const e=document.getElementById('rv'+uid);if(e)e.textContent=v+'%'}

function rG(){
const s=D.g('settings',{globalRtp:70});
document.getElementById('ct').innerHTML=`
<div class="fc"><h3>üìà Global RTP</h3><p style="font-size:.66rem;color:var(--t2);margin-bottom:10px">Applies to <span class="bg bn2">Normal</span> mode users.</p>
<div class="rtpw" style="margin-bottom:12px"><label style="font-size:.76rem">Rate: <span class="rv" id="gRV" style="font-size:1.1rem">${s.globalRtp}%</span></label><input type="range" class="rts" min="0" max="100" value="${s.globalRtp}" id="gRS" oninput="document.getElementById('gRV').textContent=this.value+'%'"><div class="rtpl"><span>0% House</span><span>50%</span><span>100% Player</span></div></div>
<button class="btn bg2" onclick="sGR()">üíæ Save</button></div>
<div class="tc"><div class="tch"><h3>üìã Guide</h3></div><div class="tcb"><table><thead><tr><th>Range</th><th>Effect</th><th>Use</th></tr></thead><tbody>
<tr><td style="color:var(--red);font-weight:700">0-30%</td><td>Rare wins</td><td>High profit</td></tr>
<tr><td style="color:var(--orange);font-weight:700">30-50%</td><td>Occasional</td><td>Standard</td></tr>
<tr><td style="color:var(--gold);font-weight:700">50-70%</td><td>Balanced</td><td>‚úÖ Recommended</td></tr>
<tr><td style="color:var(--green);font-weight:700">70-85%</td><td>Frequent</td><td>Retention</td></tr>
<tr><td style="color:var(--cyan);font-weight:700">85-95%</td><td>Very frequent</td><td>Promo only</td></tr>
<tr><td style="color:var(--purple);font-weight:700">95-100%</td><td>Almost always</td><td>‚ö†Ô∏è Special</td></tr>
</tbody></table></div></div>`}
function sGR(){const v=parseInt(document.getElementById('gRS').value),s=D.g('settings',{});s.globalRtp=v;D.s('settings',s);sync();toast('s','RTP ‚Üí '+v+'%')}

function rT(){
const tx=D.g('transactions',[]),us=D.g('users',[]);
document.getElementById('ct').innerHTML=`<div class="tc"><div class="tch"><h3>üí≥ Transactions (${tx.length})</h3><div class="tca"><button class="btn bgh bsm" onclick="expD()">üì• Export</button><button class="btn br bsm" onclick="if(confirm('Clear?')){D.s('transactions',[]);go('tx');toast('s','Cleared')}">üóëÔ∏è</button></div></div>
<div class="tcb"><table><thead><tr><th>Time</th><th>User</th><th>Type</th><th>Amount</th><th>Desc</th></tr></thead><tbody>
${tx.length?tx.slice(0,50).map(t=>{const u=us.find(x=>x.id===t.userId),d=new Date(t.date),p=t.amount>=0,tc2=t.type==='deposit'?'var(--green)':t.type==='withdraw'?'var(--red)':t.type==='bonus'?'var(--gold)':'var(--purple)';return`<tr><td style="font-size:.56rem;color:var(--t2)">${d.toLocaleDateString('id-ID')} ${d.toLocaleTimeString('id-ID',{hour:'2-digit',minute:'2-digit'})}</td><td style="font-weight:600">${u?.username||'?'}</td><td><span style="color:${tc2};font-weight:600;text-transform:uppercase;font-size:.52rem">${t.type}</span></td><td><span style="color:${p?'var(--green)':'var(--red)'};font-family:var(--m);font-weight:700">${p?'+':''}${fR(Math.abs(t.amount))}</span></td><td style="max-width:150px;overflow:hidden;text-overflow:ellipsis;font-size:.62rem;color:var(--t2)">${t.desc||'-'}</td></tr>`}).join(''):'<tr><td colspan="5" class="empty">No data</td></tr>'}
</tbody></table></div></div>`}
function expD(){const d={users:D.g('users'),transactions:D.g('transactions'),promos:D.g('promos'),settings:D.g('settings'),date:new Date().toISOString()},b=new Blob([JSON.stringify(d,null,2)],{type:'application/json'}),a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='rbs88_'+new Date().toISOString().slice(0,10)+'.json';a.click();toast('s','Exported')}

function rA(){
const us=D.g('users',[]).filter(u=>u.role==='user');
document.getElementById('ct').innerHTML=`<div class="fc"><h3>üí∞ Add Balance</h3>
<div class="fg"><label>User</label><select class="fi" id="abU"><option value="">‚Äî Select ‚Äî</option>${us.map(u=>`<option value="${u.id}">${u.username} (${fR(u.balance)})</option>`).join('')}</select></div>
<div class="fg"><label>Amount</label><input class="fi" type="number" id="abA" placeholder="Amount"></div>
<div class="fg"><label>Note</label><input class="fi" id="abN" value="Admin Bonus"></div>
<button class="btn bg2" onclick="doAB()">üí∞ Add</button></div>`}
function doAB(){const uid=parseInt(document.getElementById('abU').value),amt=parseInt(document.getElementById('abA').value),note=document.getElementById('abN').value;if(!uid)return toast('e','Select user');if(!amt||amt<=0)return toast('e','Invalid');const us=D.g('users',[]),u=us.find(x=>x.id===uid);if(!u)return;u.balance+=amt;D.s('users',us);const tx=D.g('transactions',[]);tx.unshift({id:Date.now(),userId:uid,type:'bonus',amount:amt,desc:'[Admin] '+(note||'Credit'),status:'success',date:new Date().toISOString()});D.s('transactions',tx);sync();toast('s',fR(amt)+' ‚Üí '+u.username);go('ab')}

function rP(){
const pr=D.g('promos',[]);
document.getElementById('ct').innerHTML=`<div class="fc"><h3>‚ûï Add Promo</h3>
<div class="fr"><div class="fg"><label>Code</label><input class="fi" id="pC" placeholder="WELCOME100" style="text-transform:uppercase"></div><div class="fg"><label>Name</label><input class="fi" id="pN" placeholder="Welcome Bonus"></div></div>
<div class="fr"><div class="fg"><label>Type</label><select class="fi" id="pT"><option value="percent">%</option><option value="fixed">Fixed</option></select></div><div class="fg"><label>Value</label><input class="fi" type="number" id="pV" placeholder="100"></div></div>
<div class="fr"><div class="fg"><label>Min Depo</label><input class="fi" type="number" id="pMD" value="20000"></div><div class="fg"><label>Max Bonus</label><input class="fi" type="number" id="pMB" value="1000000"></div></div>
<button class="btn bg2" onclick="aP()">‚ûï Add</button></div>
<div class="tc"><div class="tch"><h3>üéÅ Promos (${pr.length})</h3></div><div class="tcb"><table><thead><tr><th>Code</th><th>Name</th><th>Type</th><th>Value</th><th>Used</th><th>Status</th><th>Act</th></tr></thead><tbody>
${pr.map(p=>`<tr><td style="color:var(--gold);font-family:var(--m);font-weight:700">${p.code}</td><td>${p.name}</td><td>${p.type}</td><td style="font-weight:700">${p.type==='percent'?p.value+'%':fR(p.value)}</td><td>${p.usageCount||0}√ó</td><td><span class="bg ${p.status==='active'?'ba2':'bb'}">${p.status}</span></td><td>${p.status==='active'?`<button class="btn br bxs" onclick="tP(${p.id},'inactive')">Off</button>`:`<button class="btn bgr bxs" onclick="tP(${p.id},'active')">On</button>`} <button class="btn bgh bxs" onclick="dP(${p.id})">üóëÔ∏è</button></td></tr>`).join('')}
</tbody></table></div></div>`}
function aP(){const c=(document.getElementById('pC').value||'').trim().toUpperCase(),n=(document.getElementById('pN').value||'').trim(),t=document.getElementById('pT').value,v=parseInt(document.getElementById('pV').value),md=parseInt(document.getElementById('pMD').value)||20000,mb=parseInt(document.getElementById('pMB').value)||1e6;if(!c||!n||!v)return toast('e','Fill all');const pr=D.g('promos',[]);if(pr.find(p=>p.code===c))return toast('e','Exists');pr.push({id:Date.now(),code:c,name:n,type:t,value:v,minDepo:md,maxBonus:mb,status:'active',usageCount:0});D.s('promos',pr);toast('s','Added: '+c);go('pr')}
function tP(id,st){const pr=D.g('promos',[]),f=pr.find(x=>x.id===id);if(f){f.status=st;D.s('promos',pr);go('pr');toast('s',f.code+' ‚Üí '+st)}}
function dP(id){if(!confirm('Delete?'))return;D.s('promos',D.g('promos',[]).filter(p=>p.id!==id));go('pr');toast('s','Deleted')}

function rS(){
const s=D.g('settings',{});
document.getElementById('ct').innerHTML=`<div class="fc"><h3>‚öôÔ∏è General</h3>
<div class="fr"><div class="fg"><label>Min Deposit</label><input class="fi" type="number" id="sD" value="${s.minDeposit||20000}"></div><div class="fg"><label>Min WD</label><input class="fi" type="number" id="sW" value="${s.minWithdraw||50000}"></div></div>
<div class="fg"><label>Freebet</label><input class="fi" type="number" id="sF" value="${s.freebetAmount||30000}"></div>
<button class="btn bg2" onclick="sS()">üíæ Save</button></div>
<div class="fc"><h3>üõ†Ô∏è Data</h3><div style="display:flex;gap:4px;flex-wrap:wrap">
<button class="btn bbl" onclick="expD()">üì• Export</button>
<button class="btn bgh" onclick="document.getElementById('iF').click()">üì§ Import</button>
<button class="btn br" onclick="if(confirm('‚ö†Ô∏è RESET ALL?')){localStorage.clear();location.reload()}">üóëÔ∏è Reset</button>
</div><input type="file" id="iF" accept=".json" style="display:none" onchange="doI(this)"></div>
<div class="fc"><h3>üìä Storage</h3><div style="font-size:.66rem;color:var(--t2);line-height:1.7">Users: <b>${D.g('users',[]).length}</b> ‚Ä¢ TX: <b>${D.g('transactions',[]).length}</b> ‚Ä¢ Promos: <b>${D.g('promos',[]).length}</b> ‚Ä¢ ~<b>${(JSON.stringify(localStorage).length/1024).toFixed(1)}KB</b></div></div>`}
function sS(){const s=D.g('settings',{});s.minDeposit=parseInt(document.getElementById('sD').value)||20000;s.minWithdraw=parseInt(document.getElementById('sW').value)||50000;s.freebetAmount=parseInt(document.getElementById('sF').value)||30000;D.s('settings',s);sync();toast('s','Saved')}
function doI(inp){const f=inp.files[0];if(!f)return;const r=new FileReader();r.onload=e=>{try{const d=JSON.parse(e.target.result);if(d.users)D.s('users',d.users);if(d.transactions)D.s('transactions',d.transactions);if(d.promos)D.s('promos',d.promos);if(d.settings)D.s('settings',d.settings);sync();toast('s','Imported');go('dash')}catch{toast('e','Invalid')}};r.readAsText(f)}

function rB(){
const us=D.g('users',[]).filter(u=>u.role==='user'&&u.status==='active');
document.getElementById('ct').innerHTML=`<div class="fc"><h3>üì¢ Broadcast</h3><p style="font-size:.66rem;color:var(--t2);margin-bottom:10px">Send to <b style="color:var(--gold)">${us.length}</b> active member(s).</p>
<div class="fg"><label>Amount / user</label><input class="fi" type="number" id="bcA" placeholder="10000" oninput="uBC()"></div>
<div class="fg"><label>Description</label><input class="fi" id="bcN" value="Event Bonus"></div>
<div class="alt alw">Total: <b id="bcT">Rp 0</b> (${us.length} √ó amt)</div>
<button class="btn bg2" onclick="doBC()">üì¢ Send</button></div>`}
function uBC(){const n=D.g('users',[]).filter(u=>u.role==='user'&&u.status==='active').length,a=parseInt(document.getElementById('bcA').value)||0;document.getElementById('bcT').textContent=fR(a*n)}
function doBC(){const a=parseInt(document.getElementById('bcA').value),n=document.getElementById('bcN').value;if(!a||a<=0)return toast('e','Invalid');if(!confirm('Send '+fR(a)+' to ALL?'))return;const us=D.g('users',[]),tx=D.g('transactions',[]);let c=0;us.forEach(u=>{if(u.role==='user'&&u.status==='active'){u.balance+=a;tx.unshift({id:Date.now()+Math.random(),userId:u.id,type:'bonus',amount:a,desc:'[Broadcast] '+(n||'Bonus'),status:'success',date:new Date().toISOString()});c++}});D.s('users',us);D.s('transactions',tx);sync();toast('s',fR(a)+' ‚Üí '+c+' member(s)');go('bc')}

go('dash');
</script>
</body>
                                                                                                                    </html>
